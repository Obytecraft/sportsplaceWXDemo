import 'chai/register-should'
import { mount } from '@vue/test-utils'

import { SbCookieManager, SbSwitch } from '../src/components'

describe('SbCookieManager.vue', () => {
  it('Should_ShowBanner_When_ShowBannerIsTrue', () => {
    const wrapper = mount(SbCookieManager, {
      propsData: {
        showBanner: true,
        services: []
      }
    })

    wrapper.contains('.banner').should.be.true
  })

  it('Should_ModalDisplayServiceNameAndDescriptionAndSwitchComponent_When_ServiceArrayIsProvided', () => {
    const SERVICE_NAME = 'Service name'
    const SERVICE_DESC = 'This is a description'

    const wrapper = mount(SbCookieManager, {
      propsData: {
        services: [
          {
            name: SERVICE_NAME,
            description: SERVICE_DESC
          },
          {
            name: SERVICE_NAME,
            description: SERVICE_DESC
          }
        ]
      }
    })

    wrapper.vm.openModal()
    wrapper.contains('.modal-cookie-manager').should.be.true

    const modalWrapper = wrapper.find('.modal-cookie-manager')
    modalWrapper.findAll('.item-content').should.have.lengthOf(2)
    modalWrapper.contains(SbSwitch).should.be.true

    const itemWrapper = modalWrapper.findAll('.item-content').at(0)
    itemWrapper.find('.item-name').text().should.be.equal(SERVICE_NAME)
    itemWrapper.find('.item-description').text().should.be.equal(SERVICE_DESC)
  })
})
